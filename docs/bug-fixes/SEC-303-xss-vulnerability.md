# SEC-303: XSS Vulnerability

## Purpose of the PR
Fix a Cross-Site Scripting (XSS) vulnerability in the transaction description rendering that could allow malicious scripts to execute in users' browsers.

## What caused the bug?
The `TransactionList.tsx` component was using `dangerouslySetInnerHTML` to render transaction descriptions:

```tsx
// BEFORE (vulnerable)
<span dangerouslySetInnerHTML={{ __html: transaction.description }} />
```

This allowed any HTML/JavaScript stored in the `description` field to be executed in the user's browser. An attacker could inject malicious scripts like:
- `<script>alert('XSS')</script>`
- `<img src=x onerror="stealCookies()">`
- `<a href="javascript:maliciousCode()">Click me</a>`

## How did you fix it?
Replaced `dangerouslySetInnerHTML` with React's default text rendering, which automatically escapes HTML entities:

```tsx
// AFTER (safe)
{transaction.description || "-"}
```

React automatically escapes special characters like `<`, `>`, `&`, `"`, and `'` when rendering text content, preventing any HTML from being interpreted as code.

## What preventive measures can avoid similar issues?

1. **Never use `dangerouslySetInnerHTML`** unless absolutely necessary (e.g., rendering trusted rich text from a CMS)
2. **Code Review Checklist**: Add XSS checks to code review process
3. **Linting Rules**: Consider ESLint plugins like `eslint-plugin-react` which can warn about `dangerouslySetInnerHTML` usage
4. **Input Sanitization**: If HTML rendering is required, use a sanitization library like `DOMPurify`
5. **Content Security Policy (CSP)**: Implement CSP headers to limit damage from XSS attacks
6. **Security Testing**: Include XSS test cases in automated testing

## How to test it?

### Automated Tests
```bash
npm test -- --testPathPatterns="TransactionList"
```

### Manual Testing
1. Create an account and fund it
2. Check the transaction history - descriptions should display as plain text
3. If you have database access, try inserting a malicious description:
   ```sql
   UPDATE transactions SET description = '<script>alert("XSS")</script>' WHERE id = 1;
   ```
4. Refresh the transaction list - you should see the script tag as text, not an alert popup

## Files Changed
- `components/TransactionList.tsx` - Removed dangerouslySetInnerHTML
- `__tests__/unit/TransactionList.test.tsx` - Added XSS prevention tests
- `docs/bug-fixes/SEC-303-xss-vulnerability.md` - This documentation

